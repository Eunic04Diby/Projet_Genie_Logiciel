<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Gestion des Rôles et Permissions</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">
<link rel="stylesheet" href="../css/gestion_roles.css">
</head>
<body>
    <header>
  git       <div class="logo">LOGO</div>
        <div class="search-user">
            <div class="search-bar">
                <i class="fas fa-search"></i>
                <input type="text" placeholder="RECHERCHER">
            </div>
            <div class="user">
                <i class="fas fa-user-circle"></i>
                NOM UTILISATEUR
            </div>
        </div>
    </header>
    
    <div class="container">
        <div class="sidebar">
            <div class="menu">
                <div class="menu-title">MENU</div>
                <div class="menu-item">
                    <i class="fas fa-home"></i>
                    Tableau de bord
                </div>
                <div class="menu-item">
                    <i class="fas fa-users"></i>
                    Utilisateurs
                </div>
                <div class="menu-item active">
                    <i class="fas fa-lock"></i>
                    Rôles et permissions
                </div>
                <div class="menu-item">
                    <i class="fas fa-tasks"></i>
                    Actions
                </div>
                <div class="menu-item">
                    <i class="fas fa-cog"></i>
                    Paramètres
                </div>
            </div>
        </div>
        
        <main>
            <h1>GESTION DES RÔLES ET PERMISSIONS</h1>
            
            <div class="form-group">
                <label for="groupe-utilisateur">GROUPE UTILISATEUR</label>
                <div class="select-wrapper">
                    <select id="groupe-utilisateur">
                        <option value="">Sélectionnez un groupe</option>
                        <option value="admin">Administrateurs</option>
                        <option value="manager">Managers</option>
                        <option value="editor">Éditeurs</option>
                        <option value="user">Utilisateurs</option>
                    </select>
                </div>
            </div>
            
            <table class="permissions-table">
                <thead>
                    <tr>
                        <th rowspan="2">ACTION</th>
                        <th colspan="4">PERMISSION</th>
                    </tr>
                    <tr>
                        <th>CREATION</th>
                        <th>LECTURE</th>
                        <th>MODIFIER</th>
                        <th>SUPPRIMER</th>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <td>Utilisateurs</td>
                        <td>
                            <label class="checkbox-container">
                                <input type="checkbox">
                                <span class="checkmark"></span>
                            </label>
                        </td>
                        <td>
                            <label class="checkbox-container">
                                <input type="checkbox" checked>
                                <span class="checkmark"></span>
                            </label>
                        </td>
                        <td>
                            <label class="checkbox-container">
                                <input type="checkbox">
                                <span class="checkmark"></span>
                            </label>
                        </td>
                        <td>
                            <label class="checkbox-container">
                                <input type="checkbox">
                                <span class="checkmark"></span>
                            </label>
                        </td>
                    </tr>
                    <tr>
                        <td>Documents</td>
                        <td>
                            <label class="checkbox-container">
                                <input type="checkbox" checked>
                                <span class="checkmark"></span>
                            </label>
                        </td>
                        <td>
                            <label class="checkbox-container">
                                <input type="checkbox" checked>
                                <span class="checkmark"></span>
                            </label>
                        </td>
                        <td>
                            <label class="checkbox-container">
                                <input type="checkbox" checked>
                                <span class="checkmark"></span>
                            </label>
                        </td>
                        <td>
                            <label class="checkbox-container">
                                <input type="checkbox">
                                <span class="checkmark"></span>
                            </label>
                        </td>
                    </tr>
                    <tr>
                        <td>Rapports</td>
                        <td>
                            <label class="checkbox-container">
                                <input type="checkbox">
                                <span class="checkmark"></span>
                            </label>
                        </td>
                        <td>
                            <label class="checkbox-container">
                                <input type="checkbox" checked>
                                <span class="checkmark"></span>
                            </label>
                        </td>
                        <td>
                            <label class="checkbox-container">
                                <input type="checkbox">
                                <span class="checkmark"></span>
                            </label>
                        </td>
                        <td>
                            <label class="checkbox-container">
                                <input type="checkbox">
                                <span class="checkmark"></span>
                            </label>
                        </td>
                    </tr>
                    <tr>
                        <td>Paramètres</td>
                        <td>
                            <label class="checkbox-container">
                                <input type="checkbox">
                                <span class="checkmark"></span>
                            </label>
                        </td>
                        <td>
                            <label class="checkbox-container">
                                <input type="checkbox">
                                <span class="checkmark"></span>
                            </label>
                        </td>
                        <td>
                            <label class="checkbox-container">
                                <input type="checkbox">
                                <span class="checkmark"></span>
                            </label>
                        </td>
                        <td>
                            <label class="checkbox-container">
                                <input type="checkbox">
                                <span class="checkmark"></span>
                            </label>
                        </td>
                    </tr>
                    <tr>
                        <td colspan="5" class="voir-plus">VOIR PLUS</td>
                    </tr>
                </tbody>
            </table>
            
            <div class="action-button">
                <button class="attribuer-btn">ATTRIBUER</button>
            </div>
        </main>
    </div>
    
    <script>
        // Gestion des checkboxes
        document.querySelectorAll('.checkbox-container input').forEach(checkbox => {
            checkbox.addEventListener('change', function() {
                // Vous pouvez ajouter une logique ici pour gérer les changements de permissions
            });
        });
        
        // Gestion du sélecteur de groupe utilisateur
        document.getElementById('groupe-utilisateur').addEventListener('change', function() {
            const groupeSelectionne = this.value;
            if (groupeSelectionne) {
                // Simuler le chargement des permissions pour le groupe sélectionné
                // Dans une application réelle, vous feriez une requête AJAX ici
                setTimeout(() => {
                    // Réinitialiser toutes les cases
                    document.querySelectorAll('.checkbox-container input').forEach(checkbox => {
                        checkbox.checked = false;
                    });
                    
                    // Définir des permissions différentes selon le groupe
                    if (groupeSelectionne === 'admin') {
                        // Attribuer toutes les permissions aux administrateurs
                        document.querySelectorAll('.checkbox-container input').forEach(checkbox => {
                            checkbox.checked = true;
                        });
                    } else if (groupeSelectionne === 'manager') {
                        // Attribuer certaines permissions aux managers
                        const managerPerms = [0, 1, 4, 5, 6, 8, 9];
                        const checkboxes = document.querySelectorAll('.checkbox-container input');
                        managerPerms.forEach(index => {
                            if (checkboxes[index]) checkboxes[index].checked = true;
                        });
                    } else if (groupeSelectionne === 'editor') {
                        // Attribuer certaines permissions aux éditeurs
                        const editorPerms = [1, 4, 5, 8];
                        const checkboxes = document.querySelectorAll('.checkbox-container input');
                        editorPerms.forEach(index => {
                            if (checkboxes[index]) checkboxes[index].checked = true;
                        });
                    } else if (groupeSelectionne === 'user') {
                        // Attribuer des permissions limitées aux utilisateurs
                        const userPerms = [1, 5, 9];
                        const checkboxes = document.querySelectorAll('.checkbox-container input');
                        userPerms.forEach(index => {
                            if (checkboxes[index]) checkboxes[index].checked = true;
                        });
                    }
                }, 300);
            }
        });
        
        // Gestion du bouton "Voir plus"
        document.querySelector('.voir-plus').addEventListener('click', function() {
            const actionsSupplementaires = [
                "Notifications",
                "Audit",
                "Analytics",
                "Projets"
            ];
            
            // Supprimer la ligne "Voir plus"
            this.parentNode.remove();
            
            // Ajouter les actions supplémentaires
            const tbody = document.querySelector('.permissions-table tbody');
            
            actionsSupplementaires.forEach(action => {
                const tr = document.createElement('tr');
                tr.innerHTML = `
                    <td>${action}</td>
                    <td>
                        <label class="checkbox-container">
                            <input type="checkbox">
                            <span class="checkmark"></span>
                        </label>
                    </td>
                    <td>
                        <label class="checkbox-container">
                            <input type="checkbox">
                            <span class="checkmark"></span>
                        </label>
                    </td>
                    <td>
                        <label class="checkbox-container">
                            <input type="checkbox">
                            <span class="checkmark"></span>
                        </label>
                    </td>
                    <td>
                        <label class="checkbox-container">
                            <input type="checkbox">
                            <span class="checkmark"></span>
                        </label>
                    </td>
                `;
                tbody.appendChild(tr);
            });
        });
        
        // Gestion du bouton "Attribuer"
        document.querySelector('.attribuer-btn').addEventListener('click', function() {
            const groupeSelectionne = document.getElementById('groupe-utilisateur').value;
            if (!groupeSelectionne) {
                alert('Veuillez sélectionner un groupe utilisateur.');
                return;
            }
            
            // Collecter toutes les permissions cochées
            const permissions = [];
            const rows = document.querySelectorAll('.permissions-table tbody tr');
            
            rows.forEach(row => {
                if (!row.classList.contains('voir-plus')) {
                    const action = row.cells[0].textContent;
                    const checkboxes = row.querySelectorAll('input[type="checkbox"]');
                    const permTypes = ['creation', 'lecture', 'modification', 'suppression'];
                    
                    const actionPerms = {
                        action: action,
                        permissions: {}
                    };
                    
                    checkboxes.forEach((checkbox, index) => {
                        if (index < permTypes.length) {
                            actionPerms.permissions[permTypes[index]] = checkbox.checked;
                        }
                    });
                    
                    permissions.push(actionPerms);
                }
            });
            
            // Ici, vous enverriez normalement ces données au serveur
            console.log('Groupe:', groupeSelectionne);
            console.log('Permissions:', permissions);
            
            // Simuler une sauvegarde réussie
            alert('Les permissions ont été attribuées avec succès au groupe ' + groupeSelectionne);
        });
    </script>
</body>
</html>